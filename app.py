import streamlit as st
import pandas as pd
import io
import qrcode
import base64
import zipfile
from urllib.parse import urlencode
from PIL import Image, ImageDraw, ImageFont

# ================================
# æ‡‰ç”¨ç¨‹å¼æ¨™é¡Œèˆ‡é é¢è¨­å®š
# ================================
st.set_page_config(page_title="ç¤¾å€å€æ¬ŠæœƒæŠ•ç¥¨")
st.title("ç¤¾å€å€æ¬Šæœƒå¤šè­°é¡ŒæŠ•ç¥¨æ‡‰ç”¨ç¨‹å¼")

# è¨­å®šæ‚¨çš„æ‡‰ç”¨ç¨‹å¼å…¬é–‹ç¶²å€
# å¦‚æœæ‚¨é‡æ–°éƒ¨ç½²æˆ–ç¶²å€è®Šå‹•ï¼Œè«‹å‹™å¿…æ›´æ–°æ­¤è™•
APP_URL = "https://acidcocco.onrender.com"

# ================================
# è­°é¡Œæ¸…å–®
# ================================
ISSUES = [
    "è­°é¡Œä¸€ï¼šæ˜¯å¦åŒæ„å¯¦æ–½ç¤¾å€å…¬è¨­æ”¹å–„å·¥ç¨‹ï¼Ÿ",
    "è­°é¡ŒäºŒï¼šæ˜¯å¦åŒæ„èª¿æ•´ç¤¾å€ç®¡ç†è²»ï¼Ÿ",
    "è­°é¡Œä¸‰ï¼šæ˜¯å¦åŒæ„çºŒè˜ç¾æœ‰ç‰©æ¥­ç®¡ç†å…¬å¸ï¼Ÿ"
]

# åˆå§‹åŒ–æŠ•ç¥¨ç´€éŒ„
for i, issue in enumerate(ISSUES):
    if f'vote_results_{i}' not in st.session_state:
        st.session_state[f'vote_results_{i}'] = pd.DataFrame(columns=['æˆ¶è™Ÿ', 'å€åˆ†æ¯”ä¾‹', 'æŠ•ç¥¨'])

# ================================
# åœ–ç‰‡è™•ç†å‡½å¼
# ================================
def generate_qr_with_label(text, label):
    """
    ç”Ÿæˆå¸¶æœ‰æ–‡å­—æ¨™è¨»çš„ QR Code åœ–ç‰‡
    """
    qr = qrcode.QRCode(version=1, box_size=10, border=4)
    qr.add_data(text)
    qr.make(fit=True)
    img_qr = qr.make_image(fill_color="black", back_color="white").convert("RGBA")

    width, height = img_qr.size
    img_final = Image.new("RGBA", (width, height + 50), "white")
    img_final.paste(img_qr, (0, 0))

    draw = ImageDraw.Draw(img_final)
    try:
        font = ImageFont.truetype("Arial.ttf", 30)
    except IOError:
        font = ImageFont.load_default()

    text_width = draw.textlength(label, font=font)
    text_x = (width - text_width) / 2
    text_y = height + 5
    draw.text((text_x, text_y), label, (0, 0, 0), font=font)

    return img_final

# ================================
# æŠ•ç¥¨ç•Œé¢
# ================================
st.header("ä½æˆ¶æŠ•ç¥¨å€")
st.divider()

# å…§åµŒåå†Šè³‡æ–™
RAW_DATA = [
    {"æˆ¶è™Ÿ": "C1-3F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-4F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-5F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-6F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-7F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-8F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-9F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-10F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-11F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-12F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-13F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C1-14F", "å€åˆ†æ¯”ä¾‹": 0.3581},
    {"æˆ¶è™Ÿ": "C2-3F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-4F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-5F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-6F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-7F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-8F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-9F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-10F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-11F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-12F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-13F", "å€åˆ†æ¯”ä¾‹": 0.3227},
    {"æˆ¶è™Ÿ": "C2-14F", "å€åˆ†æ¯”ä¾‹": 0.3581},
    {"æˆ¶è™Ÿ": "B5-2F", "å€åˆ†æ¯”ä¾‹": 0.2596},
    {"æˆ¶è™Ÿ": "B5-3F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-4F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-5F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-6F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-7F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-8F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-9F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-10F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-11F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-12F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B5-13F", "å€åˆ†æ¯”ä¾‹": 0.2587},
    {"æˆ¶è™Ÿ": "B3-2F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-3F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-4F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-5F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-6F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-7F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-8F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-9F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-10F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-11F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-12F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B3-13F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "B1-2F", "å€åˆ†æ¯”ä¾‹": 0.246},
    {"æˆ¶è™Ÿ": "B1-3F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-4F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-5F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-6F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-7F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-8F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-9F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-10F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-11F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-12F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B1-13F", "å€åˆ†æ¯”ä¾‹": 0.2464},
    {"æˆ¶è™Ÿ": "B2-2F", "å€åˆ†æ¯”ä¾‹": 0.2496},
    {"æˆ¶è™Ÿ": "B2-3F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-4F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-5F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-6F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-7F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-8F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-9F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-10F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-11F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-12F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "B2-13F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "A5-2F", "å€åˆ†æ¯”ä¾‹": 0.2527},
    {"æˆ¶è™Ÿ": "A5-3F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-4F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-5F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-6F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-7F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-8F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-9F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-10F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-11F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-12F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A5-13F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "A3-2F", "å€åˆ†æ¯”ä¾‹": 0.2491},
    {"æˆ¶è™Ÿ": "A3-3F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-4F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-5F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-6F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-7F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-8F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-9F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-10F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-11F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-12F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A3-13F", "å€åˆ†æ¯”ä¾‹": 0.2493},
    {"æˆ¶è™Ÿ": "A2-2F", "å€åˆ†æ¯”ä¾‹": 0.3046},
    {"æˆ¶è™Ÿ": "A2-3F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-4F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-5F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-6F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-7F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-8F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-9F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-10F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-11F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-12F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A2-13F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "A1-3F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-4F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-5F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-6F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-7F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-8F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-9F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-10F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-11F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-12F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "A1-13F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "J3-3F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-4F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-5F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-6F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-7F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-8F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-9F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-10F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-11F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-12F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J3-13F", "å€åˆ†æ¯”ä¾‹": 0.2575},
    {"æˆ¶è™Ÿ": "J2-2F", "å€åˆ†æ¯”ä¾‹": 0.2717},
    {"æˆ¶è™Ÿ": "J2-3F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-4F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-5F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-6F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-7F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-8F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-9F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-10F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-11F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-12F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J2-13F", "å€åˆ†æ¯”ä¾‹": 0.2528},
    {"æˆ¶è™Ÿ": "J1-2F", "å€åˆ†æ¯”ä¾‹": 0.252},
    {"æˆ¶è™Ÿ": "J1-3F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-4F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-5F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-6F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-7F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-8F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-9F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-10F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-11F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-12F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "J1-13F", "å€åˆ†æ¯”ä¾‹": 0.2522},
    {"æˆ¶è™Ÿ": "I2-2F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-3F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-4F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-5F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-6F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-7F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-8F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-9F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-10F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-11F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-12F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I2-13F", "å€åˆ†æ¯”ä¾‹": 0.2563},
    {"æˆ¶è™Ÿ": "I1-2F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-3F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-4F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-5F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-6F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-7F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-8F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-9F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-10F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-11F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-12F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "I1-13F", "å€åˆ†æ¯”ä¾‹": 0.2559},
    {"æˆ¶è™Ÿ": "H2-2F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-3F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-4F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-5F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-6F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-7F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-8F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-9F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-10F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-11F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-12F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-13F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H2-14F", "å€åˆ†æ¯”ä¾‹": 0.3503},
    {"æˆ¶è™Ÿ": "H1-2F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-3F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-4F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-5F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-6F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-7F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-8F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-9F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-10F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-11F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-12F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-13F", "å€åˆ†æ¯”ä¾‹": 0.3072},
    {"æˆ¶è™Ÿ": "H1-14F", "å€åˆ†æ¯”ä¾‹": 0.3503},
    {"æˆ¶è™Ÿ": "G2-2F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-3F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-4F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-5F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-6F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-7F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-8F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-9F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-10F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-11F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-12F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G2-13F", "å€åˆ†æ¯”ä¾‹": 0.2551},
    {"æˆ¶è™Ÿ": "G1-2F", "å€åˆ†æ¯”ä¾‹": 0.2556},
    {"æˆ¶è™Ÿ": "G1-3F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-4F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-5F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-6F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-7F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-8F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-9F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-10F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-11F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-12F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "G1-13F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "F3-2F", "å€åˆ†æ¯”ä¾‹": 0.25},
    {"æˆ¶è™Ÿ": "F3-3F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-4F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-5F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-6F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-7F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-8F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-9F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-10F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-11F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-12F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F3-13F", "å€åˆ†æ¯”ä¾‹": 0.2503},
    {"æˆ¶è™Ÿ": "F2-2F", "å€åˆ†æ¯”ä¾‹": 0.2705},
    {"æˆ¶è™Ÿ": "F2-3F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-4F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-5F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-6F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-7F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-8F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-9F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-10F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-11F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-12F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F2-13F", "å€åˆ†æ¯”ä¾‹": 0.2518},
    {"æˆ¶è™Ÿ": "F1-3F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-4F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-5F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-6F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-7F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-8F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-9F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-10F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-11F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-12F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "F1-13F", "å€åˆ†æ¯”ä¾‹": 0.2564},
    {"æˆ¶è™Ÿ": "E5-3F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-4F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-5F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-6F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-7F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-8F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-9F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-10F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-11F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-12F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E5-13F", "å€åˆ†æ¯”ä¾‹": 0.2534},
    {"æˆ¶è™Ÿ": "E3-2F", "å€åˆ†æ¯”ä¾‹": 0.3049},
    {"æˆ¶è™Ÿ": "E3-3F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-4F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-5F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-6F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-7F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-8F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-9F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-10F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-11F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-12F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E3-13F", "å€åˆ†æ¯”ä¾‹": 0.2532},
    {"æˆ¶è™Ÿ": "E2-2F", "å€åˆ†æ¯”ä¾‹": 0.249},
    {"æˆ¶è™Ÿ": "E2-3F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-4F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-5F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-6F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-7F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-8F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-9F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-10F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-11F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-12F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E2-13F", "å€åˆ†æ¯”ä¾‹": 0.2492},
    {"æˆ¶è™Ÿ": "E1-2F", "å€åˆ†æ¯”ä¾‹": 0.2527},
    {"æˆ¶è™Ÿ": "E1-3F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-4F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-5F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-6F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-7F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-8F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-9F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-10F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-11F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-12F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "E1-13F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "D5-2F", "å€åˆ†æ¯”ä¾‹": 0.2529},
    {"æˆ¶è™Ÿ": "D5-3F", "å€åˆ†æ¯”ä¾‹": 0.2496},
    {"æˆ¶è™Ÿ": "D5-4F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-5F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-6F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-7F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-8F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-9F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-10F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-11F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-12F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D5-13F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D3-2F", "å€åˆ†æ¯”ä¾‹": 0.2498},
    {"æˆ¶è™Ÿ": "D3-3F", "å€åˆ†æ¯”ä¾‹": 0.2459},
    {"æˆ¶è™Ÿ": "D3-4F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-5F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-6F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-7F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-8F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-9F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-10F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-11F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-12F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D3-13F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D2-2F", "å€åˆ†æ¯”ä¾‹": 0.2463},
    {"æˆ¶è™Ÿ": "D2-3F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-4F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-5F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-6F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-7F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-8F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-9F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-10F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-11F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-12F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D2-13F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D1-2F", "å€åˆ†æ¯”ä¾‹": 0.2538},
    {"æˆ¶è™Ÿ": "D1-3F", "å€åˆ†æ¯”ä¾‹": 0.2595},
    {"æˆ¶è™Ÿ": "D1-4F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-5F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-6F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-7F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-8F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-9F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-10F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-11F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-12F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "D1-13F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "B1-1F", "å€åˆ†æ¯”ä¾‹": 0.2586},
    {"æˆ¶è™Ÿ": "A5-1F", "å€åˆ†æ¯”ä¾‹": 0.2467},
    {"æˆ¶è™Ÿ": "B2-1F", "å€åˆ†æ¯”ä¾‹": 0.2497},
    {"æˆ¶è™Ÿ": "A3-1F", "å€åˆ†æ¯”ä¾‹": 0.2489},
    {"æˆ¶è™Ÿ": "A2-1F", "å€åˆ†æ¯”ä¾‹": 0.2543},
    {"æˆ¶è™Ÿ": "J2-1F", "å€åˆ†æ¯”ä¾‹": 0.272},
    {"æˆ¶è™Ÿ": "I2-1F", "å€åˆ†æ¯”ä¾‹": 0.2596},
    {"æˆ¶è™Ÿ": "I1-1F", "å€åˆ†æ¯”ä¾‹": 0.2608},
    {"æˆ¶è™Ÿ": "H2-1F", "å€åˆ†æ¯”ä¾‹": 0.2935},
    {"æˆ¶è™Ÿ": "H1-1F", "å€åˆ†æ¯”ä¾‹": 0.3192},
    {"æˆ¶è™Ÿ": "G2-1F", "å€åˆ†æ¯”ä¾‹": 0.2598},
    {"æˆ¶è™Ÿ": "G1-1F", "å€åˆ†æ¯”ä¾‹": 0.2249},
    {"æˆ¶è™Ÿ": "F3-1F", "å€åˆ†æ¯”ä¾‹": 0.2506},
    {"æˆ¶è™Ÿ": "F2-1F", "å€åˆ†æ¯”ä¾‹": 0.2706},
    {"æˆ¶è™Ÿ": "E3-1F", "å€åˆ†æ¯”ä¾‹": 0.2542},
    {"æˆ¶è™Ÿ": "E2-1F", "å€åˆ†æ¯”ä¾‹": 0.2489},
    {"æˆ¶è™Ÿ": "E1-1F", "å€åˆ†æ¯”ä¾‹": 0.257},
    {"æˆ¶è™Ÿ": "D5-1F", "å€åˆ†æ¯”ä¾‹": 0.2467},
    {"æˆ¶è™Ÿ": "D3-1F", "å€åˆ†æ¯”ä¾‹": 0.2456},
    {"æˆ¶è™Ÿ": "S9", "å€åˆ†æ¯”ä¾‹": 0.126},
    {"æˆ¶è™Ÿ": "S8", "å€åˆ†æ¯”ä¾‹": 0.115},
    {"æˆ¶è™Ÿ": "S7", "å€åˆ†æ¯”ä¾‹": 0.1346},
    {"æˆ¶è™Ÿ": "S6", "å€åˆ†æ¯”ä¾‹": 0.1794},
    {"æˆ¶è™Ÿ": "S5", "å€åˆ†æ¯”ä¾‹": 0.1859},
    {"æˆ¶è™Ÿ": "S3", "å€åˆ†æ¯”ä¾‹": 0.1346},
    {"æˆ¶è™Ÿ": "S2", "å€åˆ†æ¯”ä¾‹": 0.115},
    {"æˆ¶è™Ÿ": "S1", "å€åˆ†æ¯”ä¾‹": 0.126},
]

# å°‡å­—å…¸åˆ—è¡¨è½‰æ›ç‚º DataFrame
try:
    st.session_state.data = pd.DataFrame(RAW_DATA).set_index('æˆ¶è™Ÿ')
    st.success("åå†Šè³‡æ–™å·²è¼‰å…¥ï¼")
except Exception as e:
    st.session_state.data = None
    st.error(f"åå†Šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼š{e}")

# æª¢æŸ¥ URL åƒæ•¸ä»¥åˆ¤æ–·æ˜¯å¦æœ‰æˆ¶è™Ÿè³‡è¨Š
query_params = st.query_params
household_id_from_url = query_params.get("æˆ¶è™Ÿ")

if household_id_from_url:
    if st.session_state.data is None:
        st.error("åå†Šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¨‹å¼ç¢¼ã€‚")
    else:
        if household_id_from_url in st.session_state.data.index:
            household_id = household_id_from_url
            st.info(f"æ­¡è¿æˆ¶è™Ÿ **{household_id}**ï¼")

            st.subheader("è«‹å°ä»¥ä¸‹æ‰€æœ‰è­°é¡Œé€²è¡ŒæŠ•ç¥¨ï¼š")

            voted_issues_count = 0
            for i, issue in enumerate(ISSUES):
                st.markdown(f"**{issue}**")

                if household_id in st.session_state[f'vote_results_{i}']['æˆ¶è™Ÿ'].values:
                    st.success("æ‚¨å·²å®Œæˆæ­¤è­°é¡Œçš„æŠ•ç¥¨ã€‚")
                    voted_issues_count += 1
                else:
                    vote_option = st.radio("æ‚¨çš„é¸æ“‡ï¼š", ('åŒæ„', 'ä¸åŒæ„'), key=f"radio_{i}")
                    if st.button(f"ç¢ºèªå°ã€Œè­°é¡Œ {i+1}ã€æŠ•ç¥¨", key=f"button_{i}"):
                        voter_data = st.session_state.data.loc[household_id]
                        new_vote = pd.DataFrame([{
                            'æˆ¶è™Ÿ': household_id,
                            'å€åˆ†æ¯”ä¾‹': voter_data['å€åˆ†æ¯”ä¾‹'],
                            'æŠ•ç¥¨': vote_option
                        }])
                        st.session_state[f'vote_results_{i}'] = pd.concat(
                            [st.session_state[f'vote_results_{i}'], new_vote],
                            ignore_index=True
                        )
                        st.success(f"æŠ•ç¥¨æˆåŠŸï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡ã€‚")
                        st.rerun()

            if voted_issues_count == len(ISSUES):
                st.success("æ‚¨å·²å®Œæˆæ‰€æœ‰è­°é¡Œçš„æŠ•ç¥¨ï¼")
        else:
            st.error("æ‚¨æƒæçš„ QR Code ç„¡æ•ˆã€‚è«‹ç¢ºèªæ‚¨ä½¿ç”¨çš„æ˜¯æ­£ç¢ºçš„æŠ•ç¥¨é€£çµã€‚")
else:
    st.warning("è«‹æƒææ‚¨çš„å°ˆå±¬ QR Code ä»¥é€²è¡ŒæŠ•ç¥¨ã€‚")

# ================================
# ç®¡ç†è€…å°ˆå€
# ================================
st.sidebar.header("ç®¡ç†è€…å°ˆå€")
st.sidebar.markdown("åå†Šè³‡æ–™å·²å…§åµŒåœ¨ç¨‹å¼ç¢¼ä¸­ã€‚")

if 'data' in st.session_state and st.session_state.data is not None:
    st.sidebar.divider()
    st.sidebar.subheader("QR Code ç”¢ç”Ÿå™¨")
    
    # æ‰¹æ¬¡ç”¢ç”Ÿ QR Code
    st.sidebar.markdown("##### æ‰¹æ¬¡ç”¢ç”Ÿæ‰€æœ‰æˆ¶è™Ÿçš„ QR Code")
    if st.sidebar.button("ç”¢ç”Ÿæ‰€æœ‰ QR Code å£“ç¸®æª”"):
        zip_buffer = io.BytesIO()
        with zipfile.ZipFile(zip_buffer, 'w', zipfile.ZIP_DEFLATED) as zipf:
            for household_id in st.session_state.data.index.tolist():
                params = {'æˆ¶è™Ÿ': household_id}
                full_url = f"{APP_URL}?{urlencode(params)}"
                img = generate_qr_with_label(full_url, f"æˆ¶è™Ÿ: {household_id}")

                img_buffer = io.BytesIO()
                img.save(img_buffer, format="PNG")
                img_buffer.seek(0)
                zipf.writestr(f"{household_id}_qrcode.png", img_buffer.read())

        st.sidebar.download_button(
            label="ä¸‹è¼‰ QR Code å£“ç¸®æª”",
            data=zip_buffer.getvalue(),
            file_name="all_qrcodes.zip",
            mime="application/zip"
        )
        st.sidebar.success("QR Code å£“ç¸®æª”å·²ç”¢ç”Ÿï¼")
    
    # å–®ä¸€ç”¢ç”Ÿ QR Code
    st.sidebar.markdown("---")
    st.sidebar.markdown("##### å–®ä¸€ç”¢ç”Ÿ QR Code")
    household_for_qr = st.sidebar.selectbox(
        "è«‹é¸æ“‡è¦ç”¢ç”Ÿ QR Code çš„æˆ¶è™Ÿï¼š",
        options=['è«‹é¸æ“‡'] + st.session_state.data.index.tolist()
    )

    if household_for_qr != 'è«‹é¸æ“‡':
        params = {'æˆ¶è™Ÿ': household_for_qr}
        full_url = f"{APP_URL}?{urlencode(params)}"
        img = generate_qr_with_label(full_url, f"æˆ¶è™Ÿ: {household_for_qr}")
        buf = io.BytesIO()
        img.save(buf, format="PNG")
        st.sidebar.markdown(f"#### æˆ¶è™Ÿ: {household_for_qr}")
        st.sidebar.image(img, caption="è«‹æƒææ­¤ QR Code é€²è¡ŒæŠ•ç¥¨")
        st.sidebar.download_button(
            label="ä¸‹è¼‰ QR Code åœ–ç‰‡",
            data=buf.getvalue(),
            file_name=f"{household_for_qr}_qrcode.png",
            mime="image/png"
        )
else:
    st.sidebar.warning("åå†Šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼ŒQR Code ç”¢ç”Ÿå™¨ç„¡æ³•ä½¿ç”¨ã€‚")

# ================================
# æŠ•ç¥¨å³æ™‚å ±è¡¨
# ================================
st.divider()
st.header("æŠ•ç¥¨å³æ™‚å ±è¡¨")

if 'data' in st.session_state and st.session_state.data is not None:
    for i, issue in enumerate(ISSUES):
        st.subheader(f"ğŸ“Š {issue}")
        vote_results = st.session_state[f'vote_results_{i}']
        if not vote_results.empty:
            total_votes = len(vote_results)
            st.info(f"ç›®å‰ç¸½æŠ•ç¥¨äººæ•¸ï¼š{total_votes}")
            
            agree_votes = vote_results[vote_results['æŠ•ç¥¨'] == 'åŒæ„']
            disagree_votes = vote_results[vote_results['æŠ•ç¥¨'] == 'ä¸åŒæ„']
            
            agree_count = len(agree_votes)
            disagree_count = len(disagree_votes)
            
            agree_ratio = agree_votes['å€åˆ†æ¯”ä¾‹'].sum()
            disagree_ratio = disagree_votes['å€åˆ†æ¯”ä¾‹'].sum()
            
            col1, col2 = st.columns(2)
            with col1:
                st.metric(label="åŒæ„ç¥¨æ•¸", value=agree_count, delta=f"{agree_ratio:.4f}")
                st.write("å€åˆ†æ¯”ä¾‹ï¼š", f"{agree_ratio:.4f}")
            with col2:
                st.metric(label="ä¸åŒæ„ç¥¨æ•¸", value=disagree_count, delta=f"{disagree_ratio:.4f}")
                st.write("å€åˆ†æ¯”ä¾‹ï¼š", f"{disagree_ratio:.4f}")
            
            st.write("å·²æŠ•ç¥¨æ¸…å–®ï¼š")
            st.dataframe(vote_results[['æˆ¶è™Ÿ', 'å€åˆ†æ¯”ä¾‹', 'æŠ•ç¥¨']])
        else:
            st.info("å°šç„¡æŠ•ç¥¨è¨˜éŒ„ã€‚")
        st.write("---")
else:
    st.info("åå†Šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œç„¡æ³•é¡¯ç¤ºå ±è¡¨ã€‚")
